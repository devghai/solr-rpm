# SystemD specification to control Apache Solr

[Unit]
Documentation=https://wiki.apache.org/solr/FrontPage
Description=Apache Solr Service
Requires=network-online.target
After=network-online.target
Conflicts=shutdown.target
PassEnvironment=PATH JAVA_HOME

[Service]
EnvironmentFile=SOLR_ENV_DIR/solr.in.sh
Environment="SOLR_INCLUDE=SOLR_ENV_DIR/solr.in.sh"
Type=forking
TimeoutSec=5min
IgnoreSIGPIPE=no
KillMode=process
GuessMainPID=no
# PID file needs to be in SOLR_PID_DIR defined in SOLR_RUN_DIR/solr.in.sh,
# or script will write in that dir while systemd will keep waiting
# on this path and never complete startup.
PIDFile=SOLR_RUN_DIR/solr-8983.pid
RemainAfterExit=yes
ExecStart=SOLR_INSTALL_DIR/bin/solr start
ExecStop=SOLR_INSTALL_DIR/bin/solr stop
OOMScoreAdjust=-10
Restart=on-failure
RestartForceExitStatus=SIGTERM SIGKILL
WorkingDirectory=SOLR_INSTALL_DIR
User=solr

[Install]
WantedBy=multi-user.target
Alias=solrd.service
